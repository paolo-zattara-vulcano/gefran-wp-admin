var MultilingualPress=window.MultilingualPress||{},MultilingualPressRedirectorSettings=window.MultilingualPressRedirectorSettings||{};MultilingualPress.RedirectorSettings=MultilingualPressRedirectorSettings,delete window.MultilingualPressRedirectorSettings,function(o){"use strict";MultilingualPress.BasedOnSiteSettings=function(n,t){function i(){0<o(this).val()?o(t).each(function(){o(this).prop("disabled",!1),o(this).prop("checked",!0)}):o(t).each(function(){o(this).prop("disabled",!0),o(this).prop("checked",!1)})}var a=!1;this.init=function(){if(!a){n.change(i);{const t=o("#mlp-connect-content"),e=o("#mlp-copy-comments");t.change(function(){t.prop("checked")?(e.prop("disabled",!1),e.prop("checked",!0)):(e.prop("checked",!1),e.prop("disabled",!0))})}a=!0}return this}}}(jQuery),function(){"use strict";MultilingualPress.CommentTranslationContext=function(t){var e=!1,n={};this.init=function(){return e||(n.source_site_id=t.data("source-site"),n.source_comment_id=t.data("source-comment"),n.remote_site_id=t.data("remote-site"),n.remote_comment_id=t.data("remote-comment"),n.remote_post_id=t.data("remote-post"),e=!0),this},this.sourceSiteId=function(){return Number(n.source_site_id||0)},this.sourceCommentId=function(){return Number(n.source_comment_id||0)},this.remoteSiteId=function(){return Number(n.remote_site_id||0)},this.remoteCommentId=function(){return Number(n.remote_comment_id||0)},this.remotePostId=function(){return Number(n.remote_post_id||0)}}}(jQuery),function(o,s){"use strict";MultilingualPress.CopyNavMenuSettingsMarkup=function(e){function t(){o.ajax({url:s,method:"POST",dataType:"json",data:{action:"multilingualpress_copy_nav_menu_settings_view"}}).done(function(t){t.success&&t.data&&"string"==typeof t.data&&((t=o(t.data)).length?(e.after(t),i(),a(),t=o("#select-menu-to-copy"),o(document).on("change",t,function(){i()})):onAjaxError())})}var n=!1,i=function(){var t=o(".mlp-copy-menu-settings #remote_site_id"),e=o("#select-menu-to-copy option:selected").parent().data("site_id");t.val(e)},a=function(){var t=o("#menu-name").val();o(".mlp-copy-menu-settings #current_menu_name").val(t)};this.init=function(){return n||(t(),n=!0),this}}}(jQuery,ajaxurl),function(r,u){"use strict";MultilingualPress.GetTerms=function(s){var t;this.init=function(){t&&clearTimeout(t),t=setTimeout(function(){var t,e,n,i,a,o;t=s.remoteSiteId(),e=s.sourcePostId(),n=s.remotePostId(),i=s.sourceSiteId(),a=r("#multilingualpress-site-"+t+"-tab-taxonomies").find("select"),o=[],r.each(a,function(t,e){r(e).data("taxonomy")&&o.push(r(e).data("taxonomy"))}),r.ajax({url:u,method:"POST",dataType:"json",data:{action:"multilingualpress_remote_terms",source_site_id:i,taxonomies:o,remote_site_id:t,source_post_id:e,remote_post_id:n}}).done(function(t){var o;t.success&&(o=t.data,r.each(a,function(t,e){var n="",i=o[r(e).data("taxonomy")],a=r(e).data("assignedids");r.each(i,function(t,e){n+='<option value="'+e.term_id+'"',a.includes(e.term_id)&&(n+="selected"),n=(n+=">")+e.name+"</option>"}),r(e).html(n)}))}).fail(function(){console.log(response)})},300)}}}(jQuery,ajaxurl),function(r,u){"use strict";MultilingualPress.LanguageSearch=function(a){var t,n,i,o,e,s={};this.init=function(){return t=a.closest("td"),n=r(a.data("connected")),i=t.find(".current-selection"),o=t.find(".remove-selection"),e=a.data("none"),a.autocomplete({minLength:2,select:function(t,e){return i&&i.text(e.item.label),n&&n.val(e.item.value),o&&o.show(),r(this).val(""),!1},source:function(t,e){var n,i;t.term in s?e(s[t.term]):(n=t.term,i=e,r.ajax({url:u,method:"POST",dataType:"json",data:{action:a.data("action"),search:n}}).done(function(t){return t.success&&t.data&&r.isArray(t.data)?(s[n]=t.data,i(t.data)):[]}).fail(function(){return i([])}))}}),o.click(function(t){t.preventDefault(),i.text(e),n.val(""),a.val(""),o.hide()}),this}}}(jQuery,ajaxurl),function(m,p){"use strict";MultilingualPress.NavMenu=function(i,a,o){function s(t){c.css("visibility",t?"visible":"hidden")}function e(){var t=[];return u.filter(":checked").each(function(){t.push(Number(m(this).val()||0))}),t}function n(){i.prop("disabled",!(a.length&&e().length))}function r(t){var e,n;s(!0),i.prop("disabled",!0),u.prop("disabled",!0),m.ajax({url:p,method:"POST",dataType:"json",data:(t=t,e=i.data("nonce-action"),n=i.data("nonce"),(t={action:i.data("action"),mlp_sites:t,menu:o.val()})[e]=n,t)}).done(function(t){t.success&&t.data&&"string"==typeof t.data&&(t=m(t.data)).length?a.append(t):d()}).fail(function(){d()}).always(function(){s(!1),u.prop("checked",!1),u.prop("disabled",!1),i.prop("disabled",!0)})}var u,t,c,l=!1,d=function(){alert("AJAX error.")};this.init=function(){return l||(u=m(i.data("languages")),t=m(i.data("select-all")),c=i.siblings(".spinner"),u.click(function(){n()}),t.click(function(t){t.preventDefault(),u.prop("checked",!0),n()}),i.click(function(){var t=e();t&&a.length&&r(t)}),n(),l=!0),this}}}(jQuery,ajaxurl),function(a){"use strict";MultilingualPress.NewSiteLanguage=function(t,i){function e(){var t=a(this).val(),e=function(t){t=i.find('option[data-locale="'+t+'"]');return t.length?t.attr("value"):null}(t);(e=e||function(t){t=i.find('option[data-iso="'+t+'"]');return t.length?t.attr("value"):null}(t))?i.val(e):(e=function(t){for(var e,n=t.split("_");n.length;)if(n.pop(),(e=i.find('option[data-locale="'+n.join("_")+'"]')).length)return e.attr("value");return null}(t))&&i.val(e)}var n=!1;this.init=function(){return n||(t.change(e),n=!0),this}}}(jQuery),function(){"use strict";MultilingualPress.PostTranslationContext=function(t){var e=!1,n={};this.init=function(){return e||(n.source_site_id=t.data("source-site"),n.source_post_id=t.data("source-post"),n.remote_site_id=t.data("remote-site"),n.remote_post_id=t.data("remote-post"),n.post_type=t.data("post-type"),e=!0),this},this.sourceSiteId=function(){return Number(n.source_site_id||0)},this.sourcePostId=function(){return Number(n.source_post_id||0)},this.remoteSiteId=function(){return Number(n.remote_site_id||0)},this.remotePostId=function(){return Number(n.remote_post_id||0)},this.postType=function(){return String(n.post_type||"")}}}(jQuery),function(i){"use strict";MultilingualPress.PostTranslationTaxonomies=function(t,e){var n=!1;this.init=function(){return n||(n=!0,e.length&&t.change(function(){e.toggle(!i(this).is(":checked"))})),this}}}(jQuery),function(i){"use strict";MultilingualPress.SitesRelationshipBulkSelection=function(){function t(n){n.preventDefault(),n.stopImmediatePropagation();var t=i(".mlp-relationships-languages");t.length&&t.find('input[type="checkbox"]').each(function(t,e){e.checked="select"===i(n.currentTarget).data("action")})}var e=!1;this.init=function(){return e||(i(".mlp-site-bulk-relations").on("click",t),e=!0),this}}}(jQuery),function(){"use strict";MultilingualPress.TermTranslationContext=function(t){var e=!1,n={};this.init=function(){return e||(n.source_site_id=t.data("source-site"),n.source_term_id=t.data("source-term"),n.remote_site_id=t.data("remote-site"),n.remote_term_id=t.data("remote-term"),n.taxonomy=t.data("taxonomy"),e=!0),this},this.sourceSiteId=function(){return Number(n.source_site_id||0)},this.sourceTermId=function(){return Number(n.source_term_id||0)},this.remoteSiteId=function(){return Number(n.remote_site_id||0)},this.remoteTermId=function(){return Number(n.remote_term_id||0)},this.taxonomy=function(){return String(n.taxonomy||"")}}}(jQuery),function(a,c){"use strict";c.TranslationBoxFactory={createContext:function(t,e){return new("term"===t?c.TermTranslationContext:"comment"===t?c.CommentTranslationContext:c.PostTranslationContext)(e)},create:function(t,e){var n=e.find(".tab-relation"),i=n.find(".search-input-row"),a=n.find(".update-relationship"),n=n.find(".main-row input"),o=e.find(".tab-taxonomies").find("select"),s=c.TranslationBoxFactory.createContext(t,e),r=new c.TraslationBoxTabs(e),i=new c.TranslationSearch(t,s,i,a),u=new c.TranslationRelationshipUpdater(t,i,s,e),u=new c.TranslationRelationship(u,r,i,n,a);0<o.length&&new c.GetTerms(s).init(),s.init(),r.init(),i.init(),u.init(),c.TranslationBoxFactory.handleMetaboxOnbeforeunload(),"post"===t&&new c.PostTranslationTaxonomies(e.find(".mlp-taxonomy-sync input"),e.find(".mlp-taxonomy-box")).init()},handleMetaboxOnbeforeunload:function(){var t=a('div[id*="multilingualpress_post_translation_metabox_"]');if(t.length){var i=!1;t.each(function(){a(this).find("input, textarea").each(function(){a(this).on("change textInput input",function(){i=!0})})});let n=!1;const e=document.getElementById("post");e&&e.addEventListener("submit",function(t){n=!0}),window.onbeforeunload=function(t){var e;if(i&&!n)return e=wp.i18n.__("Changes you made may not be saved.","multilingualpress"),(t||window.event).returnValue=e},a(document).on("click",".editor-post-publish-button",function(){i=!1})}}}}(jQuery,MultilingualPress),function(g,_){"use strict";MultilingualPress.TranslationRelationship=function(a,e,n,i,o){function s(){var t;return p||(t=e.findInPanel("relation","input, select, textarea"),p=e.findInAllPanels("input, select, textarea").not(t)),p}function r(){return i.filter(":checked").val()}function u(t){if(t=t||r(),n.hideResults(),"new"===t||"leave"===t)return s().attr("disabled",!1),e.enable(),o.hide().attr("disabled",!0),n.showField(!1);"nothing"===t&&o.hide().attr("disabled",!0),n.showField("existing"===t),e.activate("relation"),e.disable(),s().attr("disabled",!0),"existing"!==t&&"remove"!==t||o.attr("disabled","existing"===t).show()}function c(t){(f=f||g('<span class="spinner" style="float: none; margin: 0 10px 5px;"></span>').appendTo(o.parent())).css("visibility",t?"visible":"hidden")}function l(t,e){i.attr("disabled",!0),o.attr("disabled",!0),n.hideResults(),n.showField(!1),c(!0)}function d(t,e){u(),i.attr("disabled",!1),c(!1)}function m(t,e,n){u(),i=n.find(".tab-relation").find(".main-row input"),c(!1),(n=document.createEvent("Event")).initEvent("translation_relationship_on_ajax_success",!0,!0),document.documentElement.dispatchEvent(n)}function t(){if(void 0!==wp.data){var e=wp.data.select("core/edit-post");if(e instanceof Object){var n=!1;const i=wp.data.subscribe(function(){var t;-1===window.location.href.indexOf("&classic-editor")&&((t=e.isSavingMetaBoxes())===n||t||(n=t,a.updateRelation("new",l,m,d),i()),n=t)})}}}var p,f,h=!1;this.init=function(){if(!h){i.on("change",function(){u(g(this).val())}),o.on("click",function(t){t.preventDefault(),a.updateRelation(r(),l,m,d)}),-1!==["post-php","post-new-php"].indexOf(_)&&t(),u();{let t=g('div[id*="multilingualpress_post_translation_metabox_"]');(t.length||(t=g('div[id*="multilingualpress_comment_translation_metabox_"]')).length)&&(t.each(function(){let i=g(this),t=i.find(".mlp-taxonomy-box");t.each(function(){let n=g(this);var t=n.find("#remote-taxonomies-category");let e=0<t.length?t:n.find("input");e.each(function(){g(this).on("change",function(){var t=n.data("type");let e=i.find("input[data-slug="+t+"]");e.val(t)})})})}),t.each(function(){let n=[],i=g(this).find(".changed-fields");g(this).find("input, textarea, select").each(function(){g(this).on("change input textarea select",function(){let t="";var e=g(this).attr("name").match(/\[site-\d+\]\[([^[\]]+)\]/);e&&2<=e.length&&(t=e[1]),(n=""===i.val()?[]:n).includes(t)||(n.push(t),i.val(n))})})}))}h=!0}return this}}}(jQuery,adminpage),function(u,c,l){"use strict";c.TranslationRelationshipUpdater=function(s,i,a,r){function e(t){var e;if(-1===["existing","remove","new"].indexOf(t))return null;if("existing"===t&&!(e=i.selectedResult()))return null;var n=t,t="existing"===t?e:null;return n={task:n,source_site_id:a.sourceSiteId(),remote_site_id:a.remoteSiteId()},"term"===s?(t=t||a.remoteTermId(),n.source_term_id=a.sourceTermId(),n.remote_term_id=t,n.action="multilingualpress_update_term_relationship"):"comment"===s?(t=t||a.remoteCommentId(),n.source_comment_id=a.sourceCommentId(),n.remote_comment_id=t,n.remote_post_id=a.remotePostId(),n.action="multilingualpress_update_comment_relationship"):(t=t||a.remotePostId(),n.source_post_id=a.sourcePostId(),n.remote_post_id=t,n.action="multilingualpress_update_post_relationship"),n}this.updateRelation=function(n,t,i,a){var o=e(n);o&&(t(n,o),u.ajax({url:l,method:"POST",dataType:"json",data:o}).done(function(t){var e=(t=t).success&&t.data&&"string"==typeof t.data&&(t=u(t.data)).length?((e=r.parent()).find(".mlp-warning").remove(),r.remove(),t.appendTo(e),c.TranslationBoxFactory.create(s,t),t):null;e.length?i(n,o,e):a(n,o)}).fail(function(){a(n,o)}))}}}(jQuery,MultilingualPress,ajaxurl),function(x,y){"use strict";MultilingualPress.TranslationSearch=function(n,i,a,o){function e(t){var e=_(t);e&&(e.find("input").on("change",function(){var t=x(this);t.is(":checked")&&(o.attr("disabled",!1),e.closest("table").find("td").removeClass("selected"),t.closest("td").addClass("selected"))}),e.appendTo(c),h++)}function s(e){var t=g[n]||{};e in t?f.showResults(t[e]):(n in g||(g[n]={}),r.addClass("ui-autocomplete-loading"),x.ajax({url:y,method:"POST",dataType:"json",data:v(n,e)}).done(function(t){t=!(!t.success||!t.data)&&t.data;t&&(g[n][e]=t),f.showResults(t)}).fail(function(){f.showResults(!1)}).always(function(){r.removeClass("ui-autocomplete-loading")}))}var r,u,c,l,d,m,p,f=this,h=0,g={},_=function(t){var e,n,i;return"object"==typeof t&&t?(e=t.id||0,t=t.title||"",e?((i=(n=l.clone()).find("input")).val(e),i.attr("aria-label",t),n.find("span").text(t+" (ID: "+e+")"),n):null):null},v=function(t,e){e={action:r.data("action"),search:e,source_site_id:i.sourceSiteId(),remote_site_id:i.remoteSiteId()};return"term"===t?(e.source_term_id=i.sourceTermId(),e.remote_term_id=i.remoteTermId()):("comment"===t?(e.source_comment_id=i.sourceCommentId(),e.remote_comment_id=i.remoteCommentId()):e.source_post_id=i.sourcePostId(),e.remote_post_id=i.remotePostId()),e};function b(t){var e;13!==t.which&&(p&&clearTimeout(p),(e=r.val())!==m&&(m=e,p=setTimeout(function(){s(e),m=null},300)))}this.init=function(){var t,e;r||((r=a.find("input")).val(""),r.keyup(b).keydown(function(t){13===t.which&&t.preventDefault()}),r.on("paste",function(t){t=t.originalEvent,s((t=t)&&t.clipboardData&&"function"==typeof t.clipboardData.getData?t.clipboardData.getData("text"):"")}),u=x(r.data("results")),t=(c=u.find("table tbody")).find(".search-results-row"),e=c.find(".search-results-none"),l=t.clone().show(),d=e.clone().show(),t.remove(),e.remove())},this.showField=function(t){a.toggle(t)},this.showResults=function(t){t=t,h=0,c.empty(),o.attr("disabled",!0),"object"==typeof t&&t&&t.map?(t.map(e),h<1&&d.clone().appendTo(c)):d.clone().appendTo(c),u.show()},this.hideResults=function(t){c.empty(),u.hide(),!1!==t&&r.val("")},this.selectedResult=function(){var t=c.find("input:checked").eq(0);return t.length?t.val():null}}}(jQuery,ajaxurl),function(o){"use strict";MultilingualPress.TraslationBoxTabs=function(n){var i,a;this.init=function(){return n.tabs({active:0,activate:function(t,e){e.newTab,e.newPanel,o(this).trigger("translation-metabox-tab-activated",e)},create:function(t,e){e.tab,e.panel,o(this).trigger("translation-metabox-tab-created",e)}}),this},this.disable=function(){this.init(),n.tabs("disable")},this.enable=function(){this.init(),n.tabs("enable")},this.activate=function(t){var e=0;this.init(),t&&(a=a||n.find(".nav-tab")).each(function(){o(this).attr("id").match(/tab-([a-z-]+)$/)[1]===t&&n.tabs("option","active",e),e++})},this.findInPanel=function(t,e){return(t=(i=i||n.find(".wp-tab-panel")).find(".tab-"+t)).length?t.find(e):t},this.findInAllPanels=function(t){return(i=i||n.find(".wp-tab-panel")).find(t)}}}(jQuery),function(){"use strict";MultilingualPress.WordPressSettingsScreen=function(){let n=!1;this.init=function(){if(!n){{const t=document.getElementsByClassName("mlp_site_language")[0];const e=document.getElementById("WPLANG").parentNode.parentNode;e.insertAdjacentElement("afterend",t),t.style.display="table-row"}n=!0}return this}}}(),function(e,n,i){"use strict";e(function(){var t;"post-new-php"!==i&&"post-php"!==i||e(".mlp-translation-metabox").each(function(){n.TranslationBoxFactory.create("post",e(this))}),"profile-php"!==i&&"user-edit-php"!==i||e(".mlp-user-profile-translation-metabox").each(function(){new n.TraslationBoxTabs(e(this)).init()}),"term-php"===i&&e(".mlp-translation-metabox").each(function(){n.TranslationBoxFactory.create("term",e(this))}),"comment-php"===i&&e(".mlp-translation-metabox").each(function(){n.TranslationBoxFactory.create("comment",e(this))}),"site-new-php"===i&&(new n.NewSiteLanguage(e("#site-language"),e("#mlp-site-language")).init(),t=[e("#mlp_copy_attachments"),e("#mlp-activate-plugins"),e("#mlp-connect-content"),e("#mlp-copy-users"),e("#mlp-copy-comments")],new n.BasedOnSiteSettings(e("#mlp-base-site-id"),t).init()),"sites_page_multilingualpress-site-settings"===i&&new n.LanguageSearch(e("#mlp-site-language")).init(),"site-new-php"!==i&&"sites_page_multilingualpress-site-settings"!==i||(new n.SitesRelationshipBulkSelection).init(),"nav-menus-php"===i&&(new n.NavMenu(e("#mlp-languages-submit"),e("#menu-to-edit"),e("#menu")).init(),new n.CopyNavMenuSettingsMarkup(e(".manage-menus")).init()),"options-general-php"===i&&(new n.WordPressSettingsScreen).init()})}(jQuery,MultilingualPress,adminpage);